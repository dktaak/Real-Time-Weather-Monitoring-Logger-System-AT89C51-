C51 COMPILER V9.60.0.0   RTC_DRIVER                                                        05/09/2021 22:27:18 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE RTC_DRIVER
OBJECT MODULE PLACED IN .\Objects\rtc_driver.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE rtc_driver.c OPTIMIZE(8,SPEED) BROWSE PRINT(.\Listings\rtc_driver.lst) T
                    -ABS(2) OBJECT(.\Objects\rtc_driver.obj)

line level    source

   1          #include"header.h"
   2          //#include"DS1307.h"
   3          
   4          
   5          void rtc_set_time(u8 hr,u8 min,u8 sec,u8 format)
   6          {
   7   1        if(format == time_format_24hrs)
   8   1          hr=(hr&(~(1<<6)));
   9   1        else{
  10   2          hr=hr|(1<<6);
  11   2          hr=(format == time_format_12hrs_AM)?(hr&~(1<<5)):(hr|(1<<5));
  12   2          }
  13   1      
  14   1        i2c_byte_write_frame(0xD0,0x2,hr);//set hr
  15   1        i2c_byte_write_frame(0xD0,0x1,min);//set min
  16   1        i2c_byte_write_frame(0xD0,0x0,sec);//set sec
  17   1      }
  18          
  19          void rtc_read_time(u8 *time)
  20          {
  21   1        u8 h,m,s;
  22   1        h=i2c_byte_read_frame(0xD0,0x2);//reading hr in hexadecimal
  23   1        m=i2c_byte_read_frame(0xD0,0x1);////reading min in hexadecimal
  24   1        s=i2c_byte_read_frame(0xD0,0x0);//reading sec in hexadecimal
  25   1        
  26   1        if(((h>>6)&1)!=0){
  27   2        if(((h>>5)&1) == time_format_12hrs_AM){
  28   3          time[9]='A';
  29   3          } 
  30   2        else
  31   2          time[9]='P';
  32   2        }
  33   1        else
  34   1          time[9]='\0';
  35   1        h=h&(~(1<<6));
  36   1        h=h&(~(1<<5));
  37   1        
  38   1        time[0]=(h/16)+48;//higher byte
  39   1        time[1]=(h%16)+48;//lower byte
  40   1        time[2]=':';
  41   1        
  42   1        time[3]=(m/16)+48;//higher byte
  43   1        time[4]=(m%16)+48;//lower byte
  44   1        time[5]=':';
  45   1        
  46   1        time[6]=(s/16)+48;//higher byte
  47   1        time[7]=(s%16)+48;//lower byte
  48   1        time[8]=' ';
  49   1        time[10]='\0';  
  50   1      }
  51          //void rtc_set_date(u8 dt,u8 mn,u8 yr){
  52          //  i2c_byte_write_frame(0xD0,0x4,dt);//set hr
  53          //  i2c_byte_write_frame(0xD0,0x5,mn);//set min
  54          //  i2c_byte_write_frame(0xD0,0x6,yr);//set sec
C51 COMPILER V9.60.0.0   RTC_DRIVER                                                        05/09/2021 22:27:18 PAGE 2   

  55          //  
  56          //}
  57          
  58          
  59          //void rtc_read_date(u8 *time)
  60          //{
  61          //  u8 d,m,y;
  62          //  d=i2c_byte_read_frame(0xD0,0x4);//reading day in hexadecimal
  63          //  m=i2c_byte_read_frame(0xD0,0x5);////reading month in hexadecimal
  64          //  y=i2c_byte_read_frame(0xD0,0x6);//reading year in hexadecimal
  65          //  
  66          //  time[0]=(d/16)+48;//higher byte
  67          //  time[1]=(d%16)+48;//lower byte
  68          //  time[2]='/';
  69          //  
  70          //  time[3]=(m/16)+48;//higher byte
  71          //  time[4]=(m%16)+48;//lower byte
  72          //  time[5]='/';
  73          //  
  74          //  time[6]=(y/16)+48;//higher byte
  75          //  time[7]=(y%16)+48;//lower byte
  76          //  time[8]='\0'; 
  77          //}
  78          
  79          //void rtc_set_day(u8 day){
  80          //  i2c_byte_write_frame(0xD0,0x3,day);//set day
  81          //}
  82          //u8 rtc_read_day(){
  83          //  u8 d;
  84          //  d=i2c_byte_read_frame(0xD0,0x3);//set day
  85          //  return d;
  86          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    267    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
